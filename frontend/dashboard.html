<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - AI Meeting Monitor</title>
    <link rel="stylesheet" href="./css/styles.css">

    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-50">
    <!-- Top Bar -->
    <header class="bg-white border-b border-slate-200 sticky top-0 z-40">
       <a href="./index.html" class="font-semibold">AI Meeting Monitor</a>
        <a href="./upload.html" class="...">New Upload</a>
        <a href="./live_meeting.html" class="...">Start Live</a>

        <div class="max-w-7xl mx-auto px-6 py-4 flex items-center justify-between">
            <a href="./index.html" class="text-2xl font-bold text-slate-900">AI Meeting Monitor</a>
            <div class="flex gap-3">
                <a href="./upload.html" class="px-4 py-2 bg-slate-100 text-slate-700 rounded-lg hover:bg-slate-200 transition font-medium text-sm">New Upload</a>
                <a href="./live_meeting.html" class="px-4 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition font-medium text-sm">Start Live</a>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-6 py-8">
        <!-- Page Title -->
        <div class="mb-8">
            <h1 class="text-3xl font-bold text-slate-900 mb-2">Meetings</h1>
            <p class="text-slate-600">View and manage all your meeting recordings and live sessions.</p>
        </div>

        <!-- Filters Section -->
        <div class="bg-white rounded-2xl border border-slate-200 shadow-sm p-6 mb-8">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-4">
                <!-- Search Input -->
                <div class="lg:col-span-2">
                    <label class="block text-sm font-medium text-slate-700 mb-2">Search</label>
                    <input 
                        type="text" 
                        id="searchInput" 
                        placeholder="Search meetings…" 
                        class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-slate-900 focus:border-transparent"
                    >
                </div>

                <!-- Type Filter -->
                <div>
                    <label class="block text-sm font-medium text-slate-700 mb-2">Type</label>
                    <select id="filterType" class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-slate-900 focus:border-transparent">
                        <option value="">All</option>
                        <option value="Upload">Upload</option>
                        <option value="Live">Live</option>
                    </select>
                </div>

                <!-- Date From -->
                <div>
                    <label class="block text-sm font-medium text-slate-700 mb-2">From</label>
                    <input 
                        type="date" 
                        id="dateFrom" 
                        class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-slate-900 focus:border-transparent"
                    >
                </div>

                <!-- Date To -->
                <div>
                    <label class="block text-sm font-medium text-slate-700 mb-2">To</label>
                    <input 
                        type="date" 
                        id="dateTo" 
                        class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-slate-900 focus:border-transparent"
                    >
                </div>
            </div>

            <!-- Buttons -->
            <div class="flex gap-3">
                <button id="btnApply" class="px-6 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition font-medium text-sm">Apply</button>
                <button id="btnClear" class="px-6 py-2 bg-slate-100 text-slate-700 rounded-lg hover:bg-slate-200 transition font-medium text-sm">Clear</button>
            </div>
        </div>

        <!-- Meetings Table/Cards -->
        <div class="bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden">
            <!-- Desktop Table View -->
            <div class="hidden md:block overflow-x-auto">
                <table class="w-full">
                    <thead class="bg-slate-50 border-b border-slate-200">
                        <tr>
                            <th class="px-6 py-4 text-left text-sm font-semibold text-slate-900">Title</th>
                            <th class="px-6 py-4 text-left text-sm font-semibold text-slate-900">Type</th>
                            <th class="px-6 py-4 text-left text-sm font-semibold text-slate-900">Date</th>
                            <th class="px-6 py-4 text-left text-sm font-semibold text-slate-900">Duration</th>
                            <th class="px-6 py-4 text-left text-sm font-semibold text-slate-900">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="meetingsTable" class="divide-y divide-slate-200">
                        <!-- Rows will be inserted here by JS -->
                    </tbody>
                </table>
            </div>

            <!-- Mobile Card View -->
            <div id="meetingsTable" class="md:hidden divide-y divide-slate-200">
                <!-- Cards will be inserted here by JS -->
            </div>
        </div>
    </main>

    <!-- Details Panel (Drawer) -->
    <div id="detailsPanel" class="fixed inset-y-0 right-0 w-full sm:w-96 bg-white shadow-lg transform translate-x-full transition-transform duration-300 z-50 overflow-y-auto">
        <div class="p-6">
            <!-- Close Button -->
            <button id="closePanel" class="absolute top-4 right-4 text-slate-500 hover:text-slate-700 text-2xl leading-none">&times;</button>

            <!-- Panel Header -->
            <div class="mb-6 pr-8">
                <h2 id="detailTitle" class="text-2xl font-bold text-slate-900 mb-2">Meeting Title</h2>
                <p id="detailMeta" class="text-sm text-slate-600">Date • Type</p>
            </div>

            <!-- Transcription -->
            <details class="mb-6 group">
                <summary class="cursor-pointer font-semibold text-slate-900 py-2 hover:text-slate-700 flex items-center gap-2">
                    <span class="inline-block w-5 h-5 text-slate-600 group-open:rotate-90 transition-transform">▶</span>
                    Transcription
                </summary>
                <div class="mt-3 pl-7">
                    <pre id="detailTranscript" class="bg-slate-50 p-4 rounded-lg text-xs text-slate-700 overflow-x-auto whitespace-pre-wrap break-words max-h-64 overflow-y-auto border border-slate-200">Transcript content here...</pre>
                </div>
            </details>

            <!-- Summary -->
            <details class="mb-6 group">
                <summary class="cursor-pointer font-semibold text-slate-900 py-2 hover:text-slate-700 flex items-center gap-2">
                    <span class="inline-block w-5 h-5 text-slate-600 group-open:rotate-90 transition-transform">▶</span>
                    Summary
                </summary>
                <div class="mt-3 pl-7">
                    <p id="detailSummary" class="text-sm text-slate-700 leading-relaxed">Summary content here...</p>
                </div>
            </details>

            <!-- Action Rendering -->
            <details class="mb-6 group">
                <summary class="cursor-pointer font-semibold text-slate-900 py-2 hover:text-slate-700 flex items-center gap-2">
                    <span class="inline-block w-5 h-5 text-slate-600 group-open:rotate-90 transition-transform">▶</span>
                    Action Rendering
                </summary>
                <div class="mt-3 pl-7">
                    <ul id="detailActions" class="text-sm text-slate-700 space-y-2 list-disc list-inside">
                        <li>Action item placeholder</li>
                    </ul>
                </div>
            </details>

            <!-- Moderation -->
            <details class="group">
                <summary class="cursor-pointer font-semibold text-slate-900 py-2 hover:text-slate-700 flex items-center gap-2">
                    <span class="inline-block w-5 h-5 text-slate-600 group-open:rotate-90 transition-transform">▶</span>
                    Moderation
                </summary>
                <div class="mt-3 pl-7">
                    <div id="detailModeration" class="bg-amber-50 border border-amber-200 rounded-lg p-4 text-sm text-amber-900">
                        <p class="font-semibold mb-2">Moderation Flags:</p>
                        <ul class="space-y-1 list-disc list-inside">
                            <li>Flag placeholder</li>
                        </ul>
                    </div>
                </div>
            </details>
        </div>
    </div>

    <!-- Overlay for Panel -->
    <div id="panelOverlay" class="fixed inset-0 bg-black bg-opacity-30 hidden z-40 transition-opacity duration-300"></div>

    <script>
        // Sample data
        const sampleMeetings = [
            { id: 1, title: "Q4 Planning Session", type: "Upload", date: "2025-10-20", duration: "45 min" },
            { id: 2, title: "Team Standup", type: "Live", date: "2025-10-22", duration: "15 min" },
            { id: 3, title: "Client Presentation", type: "Upload", date: "2025-10-18", duration: "60 min" },
            { id: 4, title: "Product Review", type: "Live", date: "2025-10-21", duration: "30 min" },
            { id: 5, title: "Budget Discussion", type: "Upload", date: "2025-10-15", duration: "50 min" },
            { id: 6, title: "Engineering Sync", type: "Live", date: "2025-10-23", duration: "25 min" }
        ];

        let filteredMeetings = [...sampleMeetings];

        // Render meetings table/cards
        function renderMeetings() {
            const container = document.getElementById('meetingsTable');
            const isMobile = window.innerWidth < 768;
            
            container.innerHTML = '';

            if (filteredMeetings.length === 0) {
                container.innerHTML = '<tr class="text-center py-8"><td colspan="5" class="text-slate-500 py-8">No meetings found.</td></tr>';
                return;
            }

            filteredMeetings.forEach(meeting => {
                if (isMobile) {
                    // Mobile card view
                    const card = document.createElement('div');
                    card.className = 'p-6 hover:bg-slate-50 transition';
                    card.innerHTML = `
                        <div class="flex justify-between items-start mb-3">
                            <h3 class="font-semibold text-slate-900">${meeting.title}</h3>
                            <span class="text-xs px-2 py-1 rounded-full ${meeting.type === 'Upload' ? 'bg-blue-100 text-blue-700' : 'bg-green-100 text-green-700'}">${meeting.type}</span>
                        </div>
                        <p class="text-sm text-slate-600 mb-3">${meeting.date} • ${meeting.duration}</p>
                        <button class="view-btn w-full px-4 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition text-sm font-medium" data-id="${meeting.id}" data-title="${meeting.title}" data-type="${meeting.type}" data-date="${meeting.date}">View</button>
                    `;
                    container.appendChild(card);
                } else {
                    // Desktop table row
                    const row = document.createElement('tr');
                    row.className = 'hover:bg-slate-50 transition border-b border-slate-200 last:border-b-0';
                    row.innerHTML = `
                        <td class="px-6 py-4 text-sm font-medium text-slate-900">${meeting.title}</td>
                        <td class="px-6 py-4 text-sm">
                            <span class="px-3 py-1 rounded-full text-xs font-medium ${meeting.type === 'Upload' ? 'bg-blue-100 text-blue-700' : 'bg-green-100 text-green-700'}">${meeting.type}</span>
                        </td>
                        <td class="px-6 py-4 text-sm text-slate-600">${meeting.date}</td>
                        <td class="px-6 py-4 text-sm text-slate-600">${meeting.duration}</td>
                        <td class="px-6 py-4 text-sm">
                            <button class="view-btn px-4 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition font-medium" data-id="${meeting.id}" data-title="${meeting.title}" data-type="${meeting.type}" data-date="${meeting.date}">View</button>
                        </td>
                    `;
                    container.appendChild(row);
                }
            });

            // Attach event listeners to view buttons
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.addEventListener('click', openDetailsPanel);
            });
        }

        // Filter meetings
        function applyFilters() {
            const search = document.getElementById('searchInput').value.toLowerCase();
            const type = document.getElementById('filterType').value;
            const dateFrom = document.getElementById('dateFrom').value;
            const dateTo = document.getElementById('dateTo').value;

            filteredMeetings = sampleMeetings.filter(meeting => {
                const matchesSearch = meeting.title.toLowerCase().includes(search);
                const matchesType = !type || meeting.type === type;
                const matchesDateFrom = !dateFrom || meeting.date >= dateFrom;
                const matchesDateTo = !dateTo || meeting.date <= dateTo;

                return matchesSearch && matchesType && matchesDateFrom && matchesDateTo;
            });

            renderMeetings();
        }

        // Open details panel
        function openDetailsPanel(e) {
            const btn = e.target;
            const id = btn.dataset.id;
            const title = btn.dataset.title;
            const type = btn.dataset.type;
            const date = btn.dataset.date;
            const meeting = sampleMeetings.find(m => m.id == id);

            document.getElementById('detailTitle').textContent = title;
            document.getElementById('detailMeta').textContent = `${date} • ${type}`;
            document.getElementById('detailTranscript').textContent = `Speaker 1: Good morning everyone. Today we're discussing the ${title}.\n\nSpeaker 2: Thanks for joining. Let's start with the agenda.\n\nSpeaker 1: First, we need to review the current status and then move to action items.\n\nSpeaker 2: Sounds good. I've prepared some slides for this meeting.`;
            document.getElementById('detailSummary').textContent = `This meeting covered key points about ${title}. The team discussed current progress, identified blockers, and agreed on next steps. Follow-up actions were assigned to team members.`;
            document.getElementById('detailActions').innerHTML = `
                <li>Review project timeline and milestones</li>
                <li>Prepare detailed report for stakeholders</li>
                <li>Schedule follow-up meeting for next week</li>
                <li>Update team on action items</li>
            `;
            document.getElementById('detailModeration').innerHTML = `
                <p class="font-semibold mb-2">Moderation Flags:</p>
                <ul class="space-y-1 list-disc list-inside">
                    <li>No major issues detected</li>
                    <li>Professional tone maintained</li>
                </ul>
            `;

            const panel = document.getElementById('detailsPanel');
            const overlay = document.getElementById('panelOverlay');
            panel.classList.remove('translate-x-full');
            overlay.classList.remove('hidden');
        }

        // Close details panel
        function closeDetailsPanel() {
            const panel = document.getElementById('detailsPanel');
            const overlay = document.getElementById('panelOverlay');
            panel.classList.add('translate-x-full');
            overlay.classList.add('hidden');
        }

        // Event listeners
        document.getElementById('btnApply').addEventListener('click', applyFilters);
        document.getElementById('btnClear').addEventListener('click', () => {
            document.getElementById('searchInput').value = '';
            document.getElementById('filterType').value = '';
            document.getElementById('dateFrom').value = '';
            document.getElementById('dateTo').value = '';
            filteredMeetings = [...sampleMeetings];
            renderMeetings();
        });
        document.getElementById('closePanel').addEventListener('click', closeDetailsPanel);
        document.getElementById('panelOverlay').addEventListener('click', closeDetailsPanel);

        // Search input live filtering
        document.getElementById('searchInput').addEventListener('input', applyFilters);
        document.getElementById('filterType').addEventListener('change', applyFilters);
        document.getElementById('dateFrom').addEventListener('change', applyFilters);
        document.getElementById('dateTo').addEventListener('change', applyFilters);

        // Initial render
        renderMeetings();

        // Handle responsive changes
        window.addEventListener('resize', renderMeetings);
    </script>
</body>
</html>
